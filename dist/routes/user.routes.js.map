{"version":3,"file":"user.routes.js","names":["multer","require","storage","diskStorage","destination","req","file","cb","filename","uniqueSuffix","Date","now","Math","round","random","body","profile_pic","originalname","upload","userRouter","express","Router","get","adminProtect","getAll","getById","patch","single","celebrate","Segments","PARAMS","userIdSchema","userProtect","update","remove","put","BODY","resetPasswordSchema","changePassword"],"sources":["../../src/routes/user.routes.js"],"sourcesContent":["import express from 'express';\r\nimport { getAll, getById, remove, update, changePassword } from '../controllers/user';\r\nimport { userProtect, adminProtect } from '../middleware/auth'\r\nimport { celebrate, Segments } from 'celebrate'\r\n\r\nimport { userIdSchema, resetPasswordSchema } from '../validations/user';\r\nconst multer = require('multer')\r\n\r\nconst storage = multer.diskStorage({\r\n    destination: function (req, file, cb) {\r\n        cb(null, './public')\r\n    },\r\n    filename: function (req, file, cb) {\r\n        const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9)\r\n        req.body.profile_pic = uniqueSuffix + file.originalname\r\n        cb(null, uniqueSuffix + file.originalname)\r\n    }\r\n})\r\n\r\nconst upload = multer({ storage: storage })\r\n\r\nconst userRouter = express.Router();\r\n\r\nuserRouter.get('/', adminProtect, getAll);\r\nuserRouter.get('/:id', adminProtect, getById);\r\nuserRouter.patch('/:id', upload.single('profile_pic'), celebrate({ [Segments.PARAMS]: userIdSchema }), userProtect, update);\r\nuserRouter.delete('/:id', userProtect, remove);\r\nuserRouter.put('/password', celebrate({ [Segments.BODY]: resetPasswordSchema }), changePassword);\r\n\r\nexport default userRouter;"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AAEA;AAAwE;AAAA;AAAA;AAAA;AAAA;AACxE,IAAMA,MAAM,GAAGC,OAAO,CAAC,QAAQ,CAAC;AAEhC,IAAMC,OAAO,GAAGF,MAAM,CAACG,WAAW,CAAC;EAC/BC,WAAW,EAAE,qBAAUC,GAAG,EAAEC,IAAI,EAAEC,EAAE,EAAE;IAClCA,EAAE,CAAC,IAAI,EAAE,UAAU,CAAC;EACxB,CAAC;EACDC,QAAQ,EAAE,kBAAUH,GAAG,EAAEC,IAAI,EAAEC,EAAE,EAAE;IAC/B,IAAME,YAAY,GAAGC,IAAI,CAACC,GAAG,EAAE,GAAG,GAAG,GAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,GAAG,GAAG,CAAC;IACvET,GAAG,CAACU,IAAI,CAACC,WAAW,GAAGP,YAAY,GAAGH,IAAI,CAACW,YAAY;IACvDV,EAAE,CAAC,IAAI,EAAEE,YAAY,GAAGH,IAAI,CAACW,YAAY,CAAC;EAC9C;AACJ,CAAC,CAAC;AAEF,IAAMC,MAAM,GAAGlB,MAAM,CAAC;EAAEE,OAAO,EAAEA;AAAQ,CAAC,CAAC;AAE3C,IAAMiB,UAAU,GAAGC,mBAAO,CAACC,MAAM,EAAE;AAEnCF,UAAU,CAACG,GAAG,CAAC,GAAG,EAAEC,kBAAY,EAAEC,YAAM,CAAC;AACzCL,UAAU,CAACG,GAAG,CAAC,MAAM,EAAEC,kBAAY,EAAEE,aAAO,CAAC;AAC7CN,UAAU,CAACO,KAAK,CAAC,MAAM,EAAER,MAAM,CAACS,MAAM,CAAC,aAAa,CAAC,EAAE,IAAAC,qBAAS,sBAAIC,oBAAQ,CAACC,MAAM,EAAGC,mBAAY,EAAG,EAAEC,iBAAW,EAAEC,YAAM,CAAC;AAC3Hd,UAAU,UAAO,CAAC,MAAM,EAAEa,iBAAW,EAAEE,YAAM,CAAC;AAC9Cf,UAAU,CAACgB,GAAG,CAAC,WAAW,EAAE,IAAAP,qBAAS,sBAAIC,oBAAQ,CAACO,IAAI,EAAGC,0BAAmB,EAAG,EAAEC,oBAAc,CAAC;AAAC,eAElFnB,UAAU;AAAA"}