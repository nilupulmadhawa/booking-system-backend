{"version":3,"file":"booking.js","names":["create","asyncHandler","req","res","createBooking","body","user","result","makeResponse","status","message","getAll","getBookings","query","bookings","data","getMyBooking","filter","_id","getById","getBookingByID","params","id","ret","update","is_admin","confirmed","user_id","toString","updateBookingdetails","remove","deleteById","like","likeBooking"],"sources":["../../src/controllers/booking.js"],"sourcesContent":["import asyncHandler from '../middleware/async'\r\nimport { makeResponse } from '../utils/response'\r\nimport { createBooking, getBookings, getBookingByID, updateBookingdetails, deleteById, likeBooking } from '../services/booking'\r\n\r\nexport const create = asyncHandler(async (req, res) => {\r\n    const result = await createBooking(req.body, req.user)\r\n    if (!result) return makeResponse({ res, status: 500, message: 'Failed to add booking' })\r\n    if (result.status) return makeResponse({ res, ...result })\r\n    return makeResponse({ res, message: 'Booking added successfully' })\r\n})\r\n\r\nexport const getAll = asyncHandler(async (req, res) => {\r\n    try {\r\n        const bookings = await getBookings(req.query)\r\n        return makeResponse({ res, status: 200, data: bookings, message: 'Bookings retrieved succesfully' })\r\n    } catch (error) {\r\n        return makeResponse({ res, status: 500, message: error.message });\r\n    }\r\n})\r\n\r\nexport const getMyBooking = asyncHandler(async (req, res) => {\r\n    try {\r\n        req.query.filter = { \"user_id\": req.user._id }\r\n        const bookings = await getBookings(req.query)\r\n        return makeResponse({ res, status: 200, data: bookings, message: 'Bookings retrieved succesfully' })\r\n    } catch (error) {\r\n        return makeResponse({ res, status: 500, message: error.message });\r\n    }\r\n})\r\n\r\nexport const getById = asyncHandler(async (req, res) => {\r\n    try {\r\n        const ret = await getBookingByID(req.params.id)\r\n        if (ret.status) return makeResponse({ res, ...ret })\r\n        return makeResponse({ res, status: 200, data: ret, message: 'Booking retrieved succesfully' })\r\n    } catch (error) {\r\n        return makeResponse({ res, status: 500, message: error.message });\r\n    }\r\n})\r\n\r\nexport const update = asyncHandler(async (req, res) => {\r\n    try {\r\n        const ret = await getBookingByID(req.params.id)\r\n        if (ret.status) return makeResponse({ res, ...ret })\r\n        if (!req.user.is_admin && req.body.confirmed) { delete req.body.confirmed }\r\n        if (ret.user_id.toString() !== req.user._id.toString() && !req.user.is_admin) return makeResponse({ res, status: 401, message: 'Unauthorized' })\r\n        const result = await updateBookingdetails(req.params.id, req.body)\r\n        if (!result) return makeResponse({ res, status: 500, message: 'Failed to update booking' })\r\n        if (result.status) return makeResponse({ res, ...result })\r\n        return makeResponse({ res, status: 200, data: result, message: 'Booking updated successfully' })\r\n    } catch (error) {\r\n        return makeResponse({ res, status: 500, message: error.message });\r\n    }\r\n})\r\n\r\nexport const remove = asyncHandler(async (req, res) => {\r\n    try {\r\n        const ret = await getBookingByID(req.params.id)\r\n        if (ret.status) return makeResponse({ res, ...ret })\r\n        if (ret.user_id.toString() !== req.user._id.toString() && !req.user.is_admin) return makeResponse({ res, status: 401, message: 'Unauthorized' })\r\n        const result = await deleteById(req.params.id)\r\n        if (!result) return makeResponse({ res, status: 500, message: 'Failed to delete booking' })\r\n        if (result.status) return makeResponse({ res, ...result })\r\n        return makeResponse({ res, status: 200, data: result, message: 'Booking deleted successfully' })\r\n    } catch (error) {\r\n        return makeResponse({ res, status: 500, message: error.message });\r\n    }\r\n})\r\n\r\nexport const like = asyncHandler(async (req, res) => {\r\n    try {\r\n        const result = await likeBooking(req.params.id, req.user._id)\r\n        if (!result) return makeResponse({ res, status: 500, message: 'Failed to like booking' })\r\n        if (result.status) return makeResponse({ res, ...result })\r\n        return makeResponse({ res, status: 200, data: result, message: result.message })\r\n    } catch (error) {\r\n        return makeResponse({ res, status: 500, message: error.message });\r\n    }\r\n})\r\n"],"mappings":"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"}