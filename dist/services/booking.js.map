{"version":3,"file":"booking.js","names":["createBooking","data","user","confirmed","user_id","_id","insertBooking","getBookings","query","getAllBookings","getBookingByID","id","getOneBooking","booking","status","message","updateBookingdetails","bookingId","bookingDetails","findOneAndUpdateBooking","updatedBooking","deleteById","findOneAndRemoveBooking","deleted","likeBooking","userId","likes","some","p","toString","$push","$pull"],"sources":["../../src/services/booking.js"],"sourcesContent":["import { insertBooking, findOneAndUpdateBooking, findOneAndRemoveBooking, getOneBooking, getAllBookings } from '../repository/booking'\r\n\r\nexport const createBooking = async (data, user) => {\r\n    if (data.confirmed) { delete data.confirmed }\r\n    data = { ...data, user_id: user._id }\r\n    return await insertBooking(data)\r\n}\r\n\r\nexport const getBookings = async (query) => {\r\n    try {\r\n        return await getAllBookings(query)\r\n    } catch (error) {\r\n        return error;\r\n    }\r\n}\r\n\r\nexport const getBookingByID = async (id) => {\r\n    try {\r\n        const booking = await getOneBooking({ _id: id })\r\n        if (!booking)\r\n            return {\r\n                status: 422,\r\n                message: 'Booking not found'\r\n            }\r\n        return booking\r\n    } catch (error) {\r\n        return error;\r\n    }\r\n}\r\n\r\nexport const updateBookingdetails = async (bookingId, bookingDetails) => {\r\n    try {\r\n        const updatedBooking = await findOneAndUpdateBooking({ _id: bookingId }, bookingDetails)\r\n        if (!updatedBooking)\r\n            return {\r\n                status: 422,\r\n                message: 'Booking not found'\r\n            }\r\n        return updatedBooking\r\n    } catch (error) {\r\n        return error;\r\n    }\r\n}\r\n\r\nexport const deleteById = async (bookingId) => {\r\n    try {\r\n        const deleted = await findOneAndRemoveBooking({ _id: bookingId })\r\n        if (!deleted)\r\n            return {\r\n                status: 422,\r\n                message: 'Booking not found'\r\n            }\r\n        return {\r\n            status: 200,\r\n            message: 'deleted successfully'\r\n        }\r\n    } catch (error) {\r\n        return error;\r\n    }\r\n}\r\n\r\nexport const likeBooking = async (bookingId, userId) => {\r\n    try {\r\n        const booking = await getOneBooking({ _id: bookingId })\r\n        if (!booking.likes.some(p => p.toString() == userId.toString())) {\r\n            await updateBookingdetails({ _id: bookingId }, { $push: { likes: userId } });\r\n            return {\r\n                status: 200,\r\n                message: 'The booking has been liked'\r\n            }\r\n        } else {\r\n\r\n            await updateBookingdetails({ _id: bookingId }, { $pull: { likes: userId } });\r\n            return {\r\n                status: 200,\r\n                message: 'The booking has been disliked'\r\n            }\r\n        }\r\n    } catch (err) {\r\n        return err;\r\n    }\r\n}\r\n"],"mappings":"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"}